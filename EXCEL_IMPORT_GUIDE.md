# Excel导入课程功能指南

## 功能说明

本系统支持通过Excel文件批量导入课程信息。

## Excel文件格式要求

### 1. 文件格式
- 必须是 `.xlsx` 格式（Excel 2007及以上版本）
- 第一行必须是表头（会被跳过）
- 从第二行开始是实际数据

### 2. 列顺序和说明

| 列序号 | 列名 | 是否必填 | 数据类型 | 说明 | 示例 |
|--------|------|----------|----------|------|------|
| 1 | 课程名称 | 是 | 文本 | 课程的名称 | 高等数学 |
| 2 | 课程编码 | 否 | 文本 | 课程的唯一编码 | CS101 |
| 3 | 教师ID | 是 | 数字 | 教师在系统中的ID | 1 |
| 4 | 教室号 | 是 | 文本 | 上课的教室 | A101 |
| 5 | 上课时间 | 是 | 文本 | 上课时间描述 | 周一 1-2节 |
| 6 | 上课日期 | 是 | 日期 | 具体上课日期 | 2024-09-01 |
| 7 | 开始时间 | 否 | 时间 | 课程开始时间 | 08:00 |
| 8 | 结束时间 | 否 | 时间 | 课程结束时间 | 10:00 |
| 9 | 星期几 | 否 | 数字(1-7) | 1=周一，7=周日 | 1 |
| 10 | 预到人数 | 否 | 数字 | 预期到课人数 | 50 |
| 11 | 学期 | 否 | 文本 | 学期信息 | 2024-2025-1 |
| 12 | 状态 | 否 | 数字 | 0=已结束，1=进行中，2=未开始 | 2 |
| 13 | 备注 | 否 | 文本 | 其他说明信息 | 重点课程 |

### 3. Excel示例

```
课程名称      | 课程编码 | 教师ID | 教室号 | 上课时间    | 上课日期   | 开始时间 | 结束时间 | 星期几 | 预到人数 | 学期        | 状态 | 备注
高等数学      | MATH101  | 1      | A101   | 周一 1-2节 | 2024-09-01 | 08:00    | 10:00    | 1      | 50       | 2024-2025-1 | 2    | 重点课程
大学英语      | ENG101   | 2      | B202   | 周二 3-4节 | 2024-09-02 | 10:00    | 12:00    | 2      | 45       | 2024-2025-1 | 2    |
计算机基础    | CS101    | 3      | C303   | 周三 5-6节 | 2024-09-03 | 14:00    | 16:00    | 3      | 40       | 2024-2025-1 | 2    |
```

## 使用步骤

### 1. 准备Excel文件
- 按照上述格式准备Excel文件
- 确保必填字段都有数据
- 日期和时间格式要正确

### 2. 调用API接口

**接口地址**: `POST /api/course/import`

**请求方式**: multipart/form-data

**请求参数**:
- `file`: Excel文件（form-data）

**示例（使用curl）**:
```bash
curl -X POST "http://localhost:8080/api/course/import" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@courses.xlsx"
```

**示例（使用Postman）**:
1. 选择 POST 方法
2. 输入URL: `http://localhost:8080/api/course/import`
3. 在Headers中添加: `Authorization: Bearer YOUR_TOKEN`
4. 在Body中选择 `form-data`
5. 添加key为 `file`，类型选择 `File`
6. 选择你的Excel文件
7. 点击Send

### 3. 响应结果

**成功响应**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "count": 3,
    "message": "成功导入3条课程数据"
  }
}
```

**失败响应**:
```json
{
  "code": 500,
  "message": "导入失败：文件格式不正确",
  "data": null
}
```

## 注意事项

1. **教师ID必须存在**: 导入前请确保教师ID在系统中已存在
2. **日期格式**: 支持常见的日期格式，建议使用 `yyyy-MM-dd` 格式
3. **时间格式**: 支持常见的时间格式，建议使用 `HH:mm` 格式
4. **数据验证**: 系统会自动跳过不符合要求的行，并在日志中记录
5. **批量处理**: 支持批量导入，建议每次不超过1000条数据
6. **事务处理**: 导入操作在事务中执行，如果出错会全部回滚

## 错误处理

如果某一行数据有问题，系统会：
1. 在日志中记录具体错误信息
2. 跳过该行继续处理其他数据
3. 最终返回成功导入的数据条数

常见错误：
- **课程名称为空**: 跳过该行
- **教师ID为空**: 跳过该行
- **教室号为空**: 跳过该行
- **上课时间为空**: 跳过该行
- **上课日期为空或格式错误**: 跳过该行
- **时间格式错误**: 该字段保持为空

## 技术实现

- 使用 Apache POI 库解析Excel文件
- 使用 MyBatis-Plus 进行批量插入
- 使用 Spring 事务管理保证数据一致性
- 完整的异常处理和日志记录
